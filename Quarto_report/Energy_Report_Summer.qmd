---
title: ""
format:
  html: default
  pdf: default
  docx: default
editor: source
params:
  adress: "Me_test1"
  author: "Rudolfs"
toc: false
---

```{r}
#| label: load packages
#| echo: false
#| warning: false

#Attach Packages
library(readr)
library(here)
library(dplyr)
library(ggplot2)
library(stringr)
library(readxl)
library(tidyverse)
library(gridExtra)
library(grid)
library(jpeg)
library(cowplot)
library(googlesheets4)
library(reticulate)
library(gt)

```

```{r}
#| label: setup data
#| echo: false
#| warning: false

#Load Data
Energy_Audits <- read_excel("../data/Energy_Audit_template.xlsx")

Building_Audit <- Energy_Audits |>
  filter(Adress_Name == params$adress) # Auditor_full_name == params$Auditor_full_name

```

```{r}
#| label: setup googlesheets data
#| echo: false
#| warning: false

#Load Data
energy_test_googlesheets <- read_sheet("https://docs.google.com/spreadsheets/d/1NLoDskkQKP9rJdX1TPIwwy_xLSv0wcp77KCfG0lVxCc/edit?resourcekey=&gid=755427871#gid=755427871")

#=======filter the spreadsheet to make smaller tables for different visualizations/code chunks

recommendations <- energy_test_googlesheets |>
  #filter(Adress_Name == params$adress) |>
  select("[Furnace tune-up]":"[Other]")

```

```{r}
#| label: rank recommendations
#| echo: false
#| warning: false

ranked_recommendations <- recommendations |>
  pivot_longer(cols = "[Furnace tune-up]":"[Other]",
    names_to = "recomendation", 
    values_to = "rank")|>
    arrange((rank))|>
    filter(rank != 0)
```

### Energy Audit Report

```{r}
#| label: house image path setup
#| echo: false
#| warning: false

# Unique identifier for the image
image_id <- "House_photo_placeholder"

# Generate the file path for the image based on the identifier
image_path <- paste0("", image_id, ".png")


```

```{r, out.width = "50%", fig.align = 'center'}
#| label: image render
#| echo: false
#| warning: false
#| eval: false

# Include the image in the report
knitr::include_graphics(image_path,)
```

Homeowner: `r params$adress`

Address: `r params$adress`

Auditors: `r params$author`

Contact: mdicommunityenergy\@coa.edu, 802 266 0301

Date: `r format(Sys.time(), '%e %B %Y')`

------------------------------------------------------------------------

We conducted an energy assessment of your home on `r Building_Audit$Audit_Date`. This report will tell you what we did, what we found, and what we suggest for your home. These suggestions include information on incentives and financing to make improvements more affordable.

------------------------------------------------------------------------

![](images/Logos-together.png)

## Table of Contents

Here will be the table of contents

## 1. Summary of your Audit

#1.1 Visual Inspection and Measurements

We started with a tour and visual inspection of the inside and outside of the home. We identified any visible damage to the building, moisture control strategies, major appliances, and insulation. We measured square footage and volume of the home, as well as the area of all exterior windows and doors. We used a kill-a-watt meter to measure the electricity use of some appliances. During your audit, we used a carbon monoxide meter to measure the ambient carbon monoxide levels throughout the home.

#1.2 Attic

We entered the attic to check for insulation, air sealing, ventilation, and potential hazards such as mold. Additionally, we visually inspected the attic ventilation and any duct and pipework passing through the attic.

#1.3 Basement

We visually inspected any appliances in the basement and noted insulation levels, moisture, rodents, and any other concerns.

```{r}
#| echo: false
x <- c("Heating oil")
if (x == "Heating oil") {
  print("#1.4 Combustion Appliance Safety 
We assessed combustion appliances that burn fossil fuels such as propane, heating oil, or kerosene. These include furnaces, boilers, water heaters, and gas ovens.")
} else if (x == "Propane") {
  print("#1.4 Combustion Appliance Safety 
We assessed combustion appliances that burn fossil fuels such as propane, heating oil, or kerosene. These include furnaces, boilers, water heaters, and gas ovens.")
} else if (x == "Kerosene") {
  print("#1.4 Combustion Appliance Safety 
We assessed combustion appliances that burn fossil fuels such as propane, heating oil, or kerosene. These include furnaces, boilers, water heaters, and gas ovens.")
} else if (x == "Firewood"){
  print("#1.4 Combustion Appliance Safety 
We assessed combustion appliances that burn fossil fuels such as propane, heating oil, or kerosene. These include furnaces, boilers, water heaters, and gas ovens.")
} else if (x == "Pellets") {
  print("#1.4 Combustion Appliance Safety 
We assessed combustion appliances that burn fossil fuels such as propane, heating oil, or kerosene. These include furnaces, boilers, water heaters, and gas ovens.")
} else {
  print("")
}
```

```{=html}
<!---
**1.4 Combustion Appliance Safety** 
We assessed combustion appliances that burn fossil fuels such as propane, heating oil, or kerosene. These include furnaces, boilers, water heaters, and gas ovens.
Option 1: We visually inspected and conducted combustion safety tests on the combustion appliance(s) in your home. This included measuring for carbon monoxide and testing that flue gases are properly exhausting from the home. Option 2: We visually inspected your appliance(s) but were unable to perform combustion safety tests.

IF propane gas, Add sentence to Options 1/2: We also performed gas leak detection tests on your propane appliance(s).--->
```
#1.5 Blower Door / Air Leakage Test

We used a large fan in an exterior door to depressurize your house. This allows us to determine the volume of air leakage into the house and to locate bigger air leaks. To find leaks, we used an infrared camera to check for unusually hot and cold spots. We also checked the pressure differences of the rooms to help determine major air leak locations.
## 2. Summary of Recommendations

```{r}
#| echo: false
gt_ranked_recommendations <- gt(ranked_recommendations)

gt_ranked_recommendations
```


